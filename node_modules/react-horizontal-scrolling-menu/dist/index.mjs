import e from"react";const t="react-horizontal-scrolling-menu",n="-separator",r=`${t}-${n}`,o=`${t}--item`,i=`${t}--scroll-container`,l=`${t}--wrapper`,s=`${t}--inner-wrapper`,a=`${t}--header`,u=`${t}--arrow-left`,c=`${t}--arrow-right`,d=`${t}--footer`,v="itemId",f="data-key",m="data-index";var h=Object.freeze({__proto__:null,rootClassName:t,separatorString:n,separatorClassName:r,itemClassName:o,scrollContainerClassName:i,wrapperClassName:l,innerWrapperClassName:s,headerClassName:a,arrowLeftClassName:u,arrowRightClassName:c,footerClassName:d,id:v,dataKeyAttribute:f,dataIndexAttribute:m});function g({className:t="",children:n,onScroll:r=(()=>{}),scrollRef:o}){const l=e.useMemo((()=>`${i} ${t}`),[t]);return e.createElement("div",{className:l,onScroll:r,ref:o},n)}var p=e.memo((function({className:t,id:n,index:r,refs:o}){const i=e.useRef(null);return o[r]=i,e.createElement("div",Object.assign({className:t},{[f]:n,[m]:r},{ref:i}))}));var b=e.memo((function({children:t,className:n,id:r,index:o,refs:i}){const l=e.useRef(null);return i[String(o)]=l,e.createElement("div",Object.assign({className:n},{[f]:r,[m]:o},{ref:l}),t)}));function y(e){return"object"==typeof e&&null!=e&&1===e.nodeType}function E(e,t){return(!t||"hidden"!==e)&&"visible"!==e&&"clip"!==e}function w(e,t){if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){var n=getComputedStyle(e,null);return E(n.overflowY,t)||E(n.overflowX,t)||function(e){var t=function(e){if(!e.ownerDocument||!e.ownerDocument.defaultView)return null;try{return e.ownerDocument.defaultView.frameElement}catch(e){return null}}(e);return!!t&&(t.clientHeight<e.scrollHeight||t.clientWidth<e.scrollWidth)}(e)}return!1}function I(e,t,n,r,o,i,l,s){return i<e&&l>t||i>e&&l<t?0:i<=e&&s<=n||l>=t&&s>=n?i-e-r:l>t&&s<n||i<e&&s>n?l-t+o:0}var N,C=function(e,t){var n=window,r=t.scrollMode,o=t.block,i=t.inline,l=t.boundary,s=t.skipOverflowHiddenElements,a="function"==typeof l?l:function(e){return e!==l};if(!y(e))throw new TypeError("Invalid target");for(var u,c,d=document.scrollingElement||document.documentElement,v=[],f=e;y(f)&&a(f);){if((f=null==(c=(u=f).parentElement)?u.getRootNode().host||null:c)===d){v.push(f);break}null!=f&&f===document.body&&w(f)&&!w(document.documentElement)||null!=f&&w(f,s)&&v.push(f)}for(var m=n.visualViewport?n.visualViewport.width:innerWidth,h=n.visualViewport?n.visualViewport.height:innerHeight,g=window.scrollX||pageXOffset,p=window.scrollY||pageYOffset,b=e.getBoundingClientRect(),E=b.height,N=b.width,C=b.top,x=b.right,S=b.bottom,M=b.left,$="start"===o||"nearest"===o?C:"end"===o?S:C+E/2,k="center"===i?M+N/2:"end"===i?x:M,W=[],T=0;T<v.length;T++){var O=v[T],V=O.getBoundingClientRect(),R=V.height,A=V.width,j=V.top,H=V.right,B=V.bottom,L=V.left;if("if-needed"===r&&C>=0&&M>=0&&S<=h&&x<=m&&C>=j&&S<=B&&M>=L&&x<=H)return W;var P=getComputedStyle(O),D=parseInt(P.borderLeftWidth,10),F=parseInt(P.borderTopWidth,10),X=parseInt(P.borderRightWidth,10),Y=parseInt(P.borderBottomWidth,10),_=0,q=0,J="offsetWidth"in O?O.offsetWidth-O.clientWidth-D-X:0,U="offsetHeight"in O?O.offsetHeight-O.clientHeight-F-Y:0,z="offsetWidth"in O?0===O.offsetWidth?0:A/O.offsetWidth:0,K="offsetHeight"in O?0===O.offsetHeight?0:R/O.offsetHeight:0;if(d===O)_="start"===o?$:"end"===o?$-h:"nearest"===o?I(p,p+h,h,F,Y,p+$,p+$+E,E):$-h/2,q="start"===i?k:"center"===i?k-m/2:"end"===i?k-m:I(g,g+m,m,D,X,g+k,g+k+N,N),_=Math.max(0,_+p),q=Math.max(0,q+g);else{_="start"===o?$-j-F:"end"===o?$-B+Y+U:"nearest"===o?I(j,B,R,F,Y+U,$,$+E,E):$-(j+R/2)+U/2,q="start"===i?k-L-D:"center"===i?k-(L+A/2)+J/2:"end"===i?k-H+X+J:I(L,H,A,D,X+J,k,k+N,N);var G=O.scrollLeft,Q=O.scrollTop;$+=Q-(_=Math.max(0,Math.min(Q+_/K,O.scrollHeight-R/K+U))),k+=G-(q=Math.max(0,Math.min(G+q/z,O.scrollWidth-A/z+J)))}W.push({el:O,top:_,left:q})}return W};function x(e){return e===Object(e)&&0!==Object.keys(e).length}function S(e,t){var n=e.isConnected||e.ownerDocument.documentElement.contains(e);if(x(t)&&"function"==typeof t.behavior)return t.behavior(n?C(e,t):[]);if(n){var r=function(e){return!1===e?{block:"end",inline:"nearest"}:x(e)?e:{block:"start",inline:"nearest"}}(t);return function(e,t){void 0===t&&(t="auto");var n="scrollBehavior"in document.body.style;e.forEach((function(e){var r=e.el,o=e.top,i=e.left;r.scroll&&n?r.scroll({top:o,left:i,behavior:t}):(r.scrollTop=o,r.scrollLeft=i)}))}(C(e,r),r.behavior)}}var M=function(){return N||(N="performance"in window?performance.now.bind(performance):Date.now),N()};function $(e){var t=M(),n=Math.min((t-e.startTime)/e.duration,1),r=e.ease(n),o=e.startX+(e.x-e.startX)*r,i=e.startY+(e.y-e.startY)*r;e.method(o,i),o!==e.x||i!==e.y?requestAnimationFrame((function(){return $(e)})):e.cb()}function k(e,t,n,r,o,i){var l,s,a,u;void 0===r&&(r=600),void 0===o&&(o=function(e){return 1+--e*e*e*e*e}),l=e,s=e.scrollLeft,a=e.scrollTop,u=function(t,n){e.scrollLeft=Math.ceil(t),e.scrollTop=Math.ceil(n)},$({scrollable:l,method:u,startTime:M(),startX:s,startY:a,x:t,y:n,duration:r,ease:o,cb:i})}var W=function(e,t){var n=t||{};return function(e){return e&&!e.behavior||"smooth"===e.behavior}(n)?S(e,{block:n.block,inline:n.inline,scrollMode:n.scrollMode,boundary:n.boundary,behavior:function(e){return Promise.all(e.reduce((function(e,t){var r=t.el,o=t.left,i=t.top,l=r.scrollLeft,s=r.scrollTop;return l===o&&s===i?e:[].concat(e,[new Promise((function(e){return k(r,o,i,n.duration,n.ease,(function(){return e({el:r,left:[l,o],top:[s,i]})}))}))])}),[]))}}):Promise.resolve(S(e,t))};const T=e=>Object.values(e).map((e=>e.current)).filter(Boolean);function O(e,t,n,r,o,i){var l;const s=(null===(l=null==e?void 0:e.entry)||void 0===l?void 0:l.target)||e,a=t||"smooth";if(s)return i?null==s?void 0:s.scrollIntoView({behavior:a,inline:n||"end",block:r||"nearest"}):W(s,Object.assign({behavior:a,inline:n||"end",block:r||"nearest",duration:500},o))}const V=e=>document.querySelector(`[${f}='${e}']`),R=e=>document.querySelector(`[${m}='${e}']`);function A(t){return e.isValidElement(t)&&t||"function"==typeof t&&e.createElement(t,null)||null}const j=e=>e.filter((e=>!new RegExp(`.*${n}$`).test(e))),H=e=>{var t;return String((null===(t=null==e?void 0:e.props)||void 0===t?void 0:t[v])||String((null==e?void 0:e.key)||"").replace(/^\.\$/,""))};function B({children:t,itemClassName:i="",refs:l,separatorClassName:s=""}){const a=e.Children.toArray(t).filter(Boolean),u=a.length,c=e.useMemo((()=>`${o} ${i}`),[i]),d=e.useMemo((()=>`${r} ${s}`),[s]);return e.createElement(e.Fragment,null,a.map(((t,r)=>{const o=H(t),i=o+n,s=r+1===u;return[e.createElement(b,{className:c,id:o,key:"menuItem__"+o,refs:l,index:r},t),!s&&e.createElement(p,{className:d,id:i,refs:l,key:i,index:r+.1})]})))}const L="undefined"!=typeof window?e.useLayoutEffect:e.useEffect;function P({items:t,itemsChanged:n,refs:r,options:o}){const i=e.useRef(),[l,s]=e.useState([]),a=e.useRef(+setTimeout((()=>{}),0)),u=e.useCallback((e=>{t.set(function(e,t){return[...e].map((e=>{var n,r,o,i;const l=e.target,s=String(null!==(r=null===(n=null==l?void 0:l.dataset)||void 0===n?void 0:n.key)&&void 0!==r?r:"");return[s,{index:String(null!==(i=null===(o=null==l?void 0:l.dataset)||void 0===o?void 0:o.index)&&void 0!==i?i:""),key:s,entry:e,visible:e.intersectionRatio>=t.ratio}]}))}(e,o)),clearTimeout(a.current),a.current=+setTimeout((()=>requestAnimationFrame((()=>{s((e=>{const n=t.getVisible().map((e=>e[1].key));return JSON.stringify(e)!==JSON.stringify(n)?n:e}))}))),o.throttle)}),[t,o]);return L((()=>{const e=T(r),t=i.current||new IntersectionObserver(u,o);return i.current=t,e.forEach((e=>t.observe(e))),()=>{clearTimeout(a.current),t.disconnect(),i.current=void 0}}),[u,n,o,r]),l}const D=t=>e.Children.toArray(t).map(H).filter(Boolean);class F extends Map{toArr(){return this.sort([...this])}toItems(){return this.toArr().map((([e])=>e))}toItemsWithoutSeparators(){return j(this.toItems())}toItemsKeys(){return this.toItems()}sort(e){return e.sort((([,e],[,t])=>+e.index-+t.index))}set(e,t){return Array.isArray(e)?this.sort(e).forEach((([e,t])=>{super.set(String(e),t)})):super.set(String(e),t),this}first(){var e;return null===(e=this.toArr()[0])||void 0===e?void 0:e[1]}last(){var e,t;return null===(t=null===(e=this.toArr().slice(-1))||void 0===e?void 0:e[0])||void 0===t?void 0:t[1]}filter(e){return this.toArr().filter(e)}find(e){return this.toArr().find(e)}findIndex(e){return this.toArr().findIndex(e)}getCurrentPos(e,t){const r=this.toArr().filter((e=>{var r;return t?!(null===(r=null==e?void 0:e[0])||void 0===r?void 0:r.includes(n)):e})),o=r.findIndex((([t,n])=>t===e||n===e));return[r,o]}prev(e,t){var n;const[r,o]=this.getCurrentPos(e,!!t);return-1!==o?null===(n=r[o-1])||void 0===n?void 0:n[1]:void 0}next(e,t){var n;const[r,o]=this.getCurrentPos(e,!!t);return-1!==o?null===(n=r[o+1])||void 0===n?void 0:n[1]:void 0}getVisible(){return this.filter((e=>e[1].visible))}getVisibleElements(){return this.filter((e=>!e[0].includes(n)&&e[1].visible))}}const X={ratio:.9,rootMargin:"5px",threshold:[.05,.5,.75,.95],throttle:100};const Y=e.createContext({}),_=e=>e.reduce(((e,t)=>e.concat(t).concat(`${t}${n}`)),[]).slice(0,-1);function q(e,t){const n=j(e),r=j(t);return{prev:()=>_(function(e,t){const n=e.findIndex((e=>e===(null==t?void 0:t[0]))),r=t.length,o=n-r,i=o<0,l=i?0:o,s=e.slice(l,i?r:n);return s.length===r?s:e.slice(n,r)}(n,r)),next:()=>_(function(e,t){const n=e.findIndex((e=>{var n;return e===(null===(n=t.slice(-1))||void 0===n?void 0:n[0])})),r=t.length,o=n+r+1,i=o>e.length-1,l=i?e.length-1:o,s=e.slice(i?l-r+1:n+1,l);return s.length===r?s:e.slice(e.length-r,e.length+r)}(n,r))}}const J=e=>{var t;const r=(e=>e.filter(((e,t,r)=>{const o=0===t,i=t===r.length-1,l=new RegExp(n).test(e);return!((o||i)&&l)})))(e),o=r[Math.floor(r.length/2)];return{first:null==r?void 0:r[0],center:o,last:null===(t=r.slice(-1))||void 0===t?void 0:t[0]}},U={current:{}},z=()=>{};function K({LeftArrow:t,RightArrow:r,children:o,Header:i,Footer:v,transitionDuration:f=500,transitionEase:m,transitionBehavior:h,onInit:p=z,onUpdate:b=z,onMouseDown:y,onMouseUp:E,onMouseMove:w,onScroll:I=z,onTouchMove:N,onTouchStart:C,onTouchEnd:x,onWheel:S=z,options:M=X,scrollContainerClassName:$="",itemClassName:k="",separatorClassName:W="",wrapperClassName:T="",apiRef:H=U,RTL:L,noPolyfill:_}){const q=A(t),J=A(r),K=A(i),G=A(v),Q=e.useRef(null),[Z]=e.useState({}),ee=e.useMemo((()=>Object.assign(Object.assign(Object.assign({},X),M),{root:Q.current})),[M,Q.current]),te=e.useRef(new F).current,ne=function(t,r){const[o,i]=e.useState(""),l=e.useMemo((()=>D(t)),[t]);return e.useEffect((()=>{const e=l.filter(Boolean).join("");r.toItemsWithoutSeparators().filter((e=>!l.includes(e))).forEach((e=>{var t,o;const i=(null===(t=r.last())||void 0===t?void 0:t.key)===e&&(null===(o=r.prev(e))||void 0===o?void 0:o.key)||"";r.delete(i),r.delete(`${e}${n}`),r.delete(e)})),i(e)}),[l,r]),o}(o,te),re=P(e.useMemo((()=>({items:te,itemsChanged:ne,options:ee,refs:Z})),[te,ne,Z,ee])),oe=!!re.length,ie=e.useMemo((()=>function(e,t=[],n,r,o,i){var l,s;const a=j(t),u=!!(null===(l=e.first())||void 0===l?void 0:l.visible),c=!!(null===(s=e.last())||void 0===s?void 0:s.visible),d=t=>{var n;return null===(n=e.find((e=>e[1].key===String(t))))||void 0===n?void 0:n[1]},v=()=>{var t,n;return e.prev(null===(n=null===(t=e.getVisible())||void 0===t?void 0:t[0])||void 0===n?void 0:n[1])},f=()=>{var t,n,r,o;return e.next(null===(o=null===(r=null===(n=null===(t=e.getVisible())||void 0===t?void 0:t.slice)||void 0===n?void 0:n.call(t,-1))||void 0===r?void 0:r[0])||void 0===o?void 0:o[1])};return{getItemById:d,getItemElementById:V,getItemByIndex:t=>{var n;return null===(n=e.find((e=>String(e[1].index)===String(t))))||void 0===n?void 0:n[1]},getItemElementByIndex:R,getNextItem:f,getNextElement:()=>{var t,n,r,o;return e.next(null===(o=null===(r=null===(n=null===(t=e.getVisibleElements())||void 0===t?void 0:t.slice)||void 0===n?void 0:n.call(t,-1))||void 0===r?void 0:r[0])||void 0===o?void 0:o[1],!0)},getPrevItem:v,getPrevElement:()=>{var t,n;return e.prev(null===(n=null===(t=e.getVisibleElements())||void 0===t?void 0:t[0])||void 0===n?void 0:n[1],!0)},isFirstItemVisible:u,isItemVisible:e=>a.includes(String(e)),isLastItem:t=>e.last()===d(t),isLastItemVisible:c,scrollNext:(e,t,l,{duration:s,ease:a,boundary:u=(null==n?void 0:n.current)}={})=>{const c=null!=e?e:null==r?void 0:r.behavior;return O(f(),c,t||"start",l||"nearest",{boundary:u,duration:null!=s?s:null==r?void 0:r.duration,ease:null!=a?a:null==r?void 0:r.ease},o||i)},scrollPrev:(e,t,l,{duration:s,ease:a,boundary:u=(null==n?void 0:n.current)}={})=>{const c=null!=e?e:null==r?void 0:r.behavior;return O(v(),c,t||"end",l||"nearest",{boundary:u,duration:null!=s?s:null==r?void 0:r.duration,ease:null!=a?a:null==r?void 0:r.ease},o||i)},scrollToItem:(e,t,o,l,s)=>{var a,u;return O(e,null!=t?t:null==r?void 0:r.behavior,o,l,Object.assign(Object.assign({boundary:null==n?void 0:n.current},s),{duration:null!==(a=null==s?void 0:s.duration)&&void 0!==a?a:null==r?void 0:r.duration,ease:null!==(u=null==s?void 0:s.ease)&&void 0!==u?u:null==r?void 0:r.ease}),i)},visibleElements:a,visibleElementsWithSeparators:t,visibleItems:t,visibleItemsWithoutSeparators:a}}(te,re,Q,{duration:f,ease:m,behavior:h},L,_)),[te,re,ne,L,_]),le=e.useCallback((()=>Object.assign(Object.assign({},ie),{initComplete:oe,items:te,visibleElementsWithSeparators:re,scrollContainer:Q})),[ie,oe,te,re,Q]),[se,ae]=e.useState(le);!function({cb:t=(()=>{}),condition:n,hash:r}){e.useEffect((()=>{n&&t()}),[r,n])}({cb:()=>b(se),condition:function({cb:t,condition:n}){const[r,o]=e.useState(!1);return e.useEffect((()=>{n&&!r&&(o(!0),t())}),[n,r]),r}({cb:()=>p(se),condition:oe}),hash:JSON.stringify(re.concat(String(null==se?void 0:se.isFirstItemVisible)).concat(String(null==se?void 0:se.isLastItemVisible)))}),e.useEffect((()=>ae(le())),[le]),H.current=se;const ue=e.useCallback((e=>I(se,e)),[I,se]),ce=e.useCallback((e=>S(se,e)),[S,se]),de=e.useMemo((()=>`${l} ${T}`),[T]),ve=e.useMemo((()=>`${$}${L?" rtl":""}`),[L,$]);return e.createElement("div",{className:de,onWheel:ce,onMouseDown:null==y?void 0:y(se),onMouseUp:null==E?void 0:E(se),onMouseMove:null==w?void 0:w(se),onTouchStart:null==C?void 0:C(se),onTouchMove:null==N?void 0:N(se),onTouchEnd:null==x?void 0:x(se)},e.createElement(Y.Provider,{value:se},e.createElement("div",{className:a},K),e.createElement("div",{className:s},e.createElement("div",{className:u},q),e.createElement(g,{className:ve,onScroll:ue,scrollRef:Q},e.createElement(B,{refs:Z,itemClassName:k,separatorClassName:W},o)),e.createElement("div",{className:c},J)),e.createElement("div",{className:d},G)))}export{K as ScrollMenu,Y as VisibilityContext,h as constants,J as getItemsPos,q as slidingWindow};
